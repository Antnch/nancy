version: 2
jobs:
  build:
    working_directory: ~/nancy
    docker:
      - image: ubuntu:16.04
    steps:
      - run:
          name: Install software
          command: |
            apt-get update && apt-get install -y sudo wget \
            && wget get.docker.com -q -S -O - | sudo sh
      - checkout
      - run:
          name: Tests
          command: |
            errcount=0; \
            for f in tests/*.sh; do printf "$f\t\t" && bash "$f" -H; \
              status=$?; \
              if [ $status -ne 0 ]; then \
                errcount="$(($errcount+1))"; \
              fi; done; \
              [ $errcount -ne 0 ] && echo -e "Oh no! $errcount tests failed" \
              [ $errcount -ne 0 ] && exit 1

